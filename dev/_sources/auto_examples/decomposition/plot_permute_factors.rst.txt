
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/decomposition/plot_permute_factors.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_decomposition_plot_permute_factors.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_decomposition_plot_permute_factors.py:


Permuting CP factors
===============================================
On this page, you will find examples showing how to use tensorly.cp_tensor.cp_permute_factors function.

.. GENERATED FROM PYTHON SOURCE LINES 8-15

Introduction
-----------------------
This function compares factors of a reference cp tensor with factors of another tensor
(or list of tensor) in order to match component order. Permutation occurs on the columns of factors,
minimizing the cosine distance to reference cp tensor with scipy Linear Sum Assignment method.
The permuted tensor (or list of tensors) and list of permutation for each permuted tensors are returned.
Tensorly CPTensor should be used as an input to permute their factors and weights simultaneously.

.. GENERATED FROM PYTHON SOURCE LINES 15-21

.. code-block:: default


    import tensorly as tl
    from tensorly.random import random_cp
    from tensorly.cp_tensor import cp_permute_factors
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 22-25

Create synthetic tensor
-----------------------
Here, we create a random tensor, then we permute its factors manually.

.. GENERATED FROM PYTHON SOURCE LINES 25-45

.. code-block:: default



    shape = (30, 40, 50)
    rank = 4

    # one reference cp tensor
    cp_tensor_1 = random_cp(shape, rank)

    # two target cp tensors
    cp_tensor_2 = cp_tensor_1.cp_copy()
    cp_tensor_3 = cp_tensor_1.cp_copy()

    col_order_1 = [1, 0, 3, 2]
    for f in range(3):
        cp_tensor_2.factors[f] = cp_tensor_2.factors[f][:, col_order_1]

    col_order_2 = [3, 1, 2, 0]
    for f in range(3):
        cp_tensor_3.factors[f] = cp_tensor_3.factors[f][:, col_order_2]








.. GENERATED FROM PYTHON SOURCE LINES 46-53

Permute target CPTensors
------------------------
Now, we can use these two manipulated CPTensors as inputs to the permutation function. Here,
cp_tensor_1 will be used as a reference to permute other CPTensors, which are called target CPTensors.
There is no limitation for the number of target CPTensors but there should be only one reference CPTensor.
Results will include permuted CPTensors and permutation for each permuted cp tensor.
It should be noted that, reference CPTensor won't be included among the output CPTensors.

.. GENERATED FROM PYTHON SOURCE LINES 53-56

.. code-block:: default


    cp_tensors, permutation = cp_permute_factors(cp_tensor_1, [cp_tensor_2, cp_tensor_3])








.. GENERATED FROM PYTHON SOURCE LINES 57-59

As it is expected, permutation variable stores two lists which are equal to predefined col_order_1
col_order_2 above.

.. GENERATED FROM PYTHON SOURCE LINES 59-62

.. code-block:: default


    print(permutation)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    [array([1, 0, 3, 2]), array([3, 1, 2, 0])]




.. GENERATED FROM PYTHON SOURCE LINES 63-65

We can also observe the evolution of the factor columns order by plotting one column
before and after permuting.

.. GENERATED FROM PYTHON SOURCE LINES 65-75

.. code-block:: default


    fig, axs = plt.subplots(1, 3)
    plt.subplots_adjust(hspace=1.5)
    fig.set_size_inches(15, fig.get_figheight(), forward=True)
    axs[0].plot(cp_tensor_1.factors[0][:, 0].T)
    axs[0].set_title("Reference cp tensor")
    axs[1].plot(cp_tensor_2.factors[0][:, 0].T)
    axs[1].set_title("Target cp tensor")
    axs[2].plot(cp_tensors[0].factors[0][:, 0].T)
    axs[2].set_title("Permuted cp tensor")



.. image-sg:: /auto_examples/decomposition/images/sphx_glr_plot_permute_factors_001.png
   :alt: Reference cp tensor, Target cp tensor, Permuted cp tensor
   :srcset: /auto_examples/decomposition/images/sphx_glr_plot_permute_factors_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(0.5, 1.0, 'Permuted cp tensor')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.238 seconds)


.. _sphx_glr_download_auto_examples_decomposition_plot_permute_factors.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_permute_factors.py <plot_permute_factors.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_permute_factors.ipynb <plot_permute_factors.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
